define(function(){return"﻿﻿\r\n<script type=\"text/lizard-config\">\r\n{\r\n  url_schema: '/ui/group_select',\r\n  viewName: 'group_select',\r\n  models: {\r\n    apis: [],\r\n    filter: function(datas) {\r\n      return {\r\n\r\n      };\r\n    }\r\n  },\r\n  view:{\r\n    viewport: Lizard.T(\"viewportTmpl\")\r\n  },\r\n  controller: 'webresource/controllers/ui/group_select.js'\r\n}\r\n</script>\r\n\r\n<script id=\"viewportTmpl\" type=\"text/lizard-template\">\r\n  <div class=\"cui-citys-bd\">\r\n  </div>\r\n<pre><code>\r\n/*\r\ngroupselect本身为2个以上的select组件使用，再加上changed逻辑，会比较复杂，这里先以生日选择为例\r\n*/\r\n</code></pre>\r\n  <div style=\" border: 1px solid black; \">\r\n    <input type=\"text\" class=\"js_demo01_val\" placeholder=\"可按格式编辑年月日：1988-12-8\" />\r\n  </div>\r\n  <br />\r\n  <span class=\"btn-secondary js_demo01\">生日选择器</span>\r\n  <pre><code>\r\n/**\r\n * Created by jp_wang on 2014/11/20.\r\n */\r\ndefine(['UIDemoView', 'UIGroupSelect', 'cStore', 'cCoreInherit'], function (UIDemoView, UIGroupSelect, AbstractStore, Inherit) {\r\n  var BirthDay = Inherit.Class(AbstractStore, {\r\n    __propertys__: function () {\r\n      this.key = 'demo21_UI_depart_date';\r\n      this.lifeTime = '1D';\r\n    },\r\n    initialize: function ($super, options) {\r\n      $super(options);\r\n    }\r\n  });\r\n  var birth = BirthDay.getInstance();\r\n  var View = UIDemoView.extend({\r\n    events: {\r\n      'click .js_demo01': 'demo01'\r\n    },\r\n    //\r\n    _getBirthInitData: function () {\r\n      //处理数据逻辑代码\r\n      var i, len, item;\r\n      var _now = new Date();\r\n      var _year = _now.getFullYear();\r\n      var yearData = [];\r\n      var monthData = [];\r\n      var dayData = [];\r\n      len = _year - 1939;\r\n      for (i = 0; i < len; i++) {\r\n        item = {\r\n          id: 1940 + i,\r\n          name: (1940 + i) + '年'\r\n        };\r\n        yearData.push(item);\r\n      }\r\n      for (i = 0; i < 12; i++) {\r\n        item = {\r\n          id: 1 + i,\r\n          name: ((1 + i) < 10 ? ('0' + (1 + i)) : (1 + i)) + '月'\r\n        };\r\n        monthData.push(item);\r\n      }\r\n      for (i = 0; i < 31; i++) {\r\n        item = {\r\n          id: 1 + i,\r\n          name: ((1 + i) < 10 ? ('0' + (1 + i)) : (1 + i)) + '日'\r\n        };\r\n        dayData.push(item);\r\n      }\r\n      return {\r\n        yearData: yearData,\r\n        monthData: monthData,\r\n        dayData: dayData\r\n      };\r\n    },\r\n    demo01: function () {\r\n      //由文本框获取当前日期项目\r\n      var curBirth = this.$('.js_demo01_val');\r\n      var birthArray = curBirth.val().split('-');\r\n      var year_sec, month_sec, day_sec, scope = this;\r\n      var birthObj = this._getBirthInitData();\r\n      var dayData = birthObj.dayData;\r\n      //当年或者月改变后，日期需要判断闰年，或者日期变化的行为\r\n      var _yearOrMonthChanged = function (yearItem, monthItem) {\r\n        //处理month的时候日应该有所变化\r\n        var dayFlag = { 1: 31, 2: 28, 3: 31, 4: 30, 5: 31, 6: 30, 7: 31, 8: 31, 9: 30, 10: 31, 11: 30, 12: 31 };\r\n        //闰年处理，需要先获取年份\r\n        if (_.dateUtil.isLeapYear(yearItem.id)) {\r\n          dayFlag[2] = 29;\r\n        }\r\n        var changed = false;\r\n        //此处重置日期接口，并且需要重置“天”的dom结构\r\n        for (var i = 0; i < 31; i++) {\r\n          //设置该项不可选取\r\n          dayData[i].disabled = true;\r\n        }\r\n        for (i = 31; i > dayFlag[monthItem.id] && i > 0; i--) {\r\n          dayData[i - 1].disabled = false;\r\n          changed = true;\r\n        }\r\n        if (changed) {\r\n          scope.list01.scrollArr[2].reload(dayData);\r\n        }\r\n      };\r\n      if (!this.list01) {\r\n        this.list01 = new UIGroupSelect({\r\n          data: [birthObj.yearData, birthObj.monthData, birthObj.dayData],\r\n          changedArr: [\r\n            //年改变触发回调\r\n            function (item) {\r\n              _yearOrMonthChanged(this.scrollArr[0].getSelected(), this.scrollArr[1].getSelected());\r\n              //scope._setBirth();\r\n              this.setTips(this.scrollArr[0].getSelected().id + '-' + this.scrollArr[1].getSelected().id + '-' + this.scrollArr[2].getSelected().id);\r\n            },\r\n            //月改变触发回调\r\n            function (item) {\r\n              _yearOrMonthChanged(this.scrollArr[0].getSelected(), this.scrollArr[1].getSelected());\r\n              //scope._setBirth();\r\n              this.setTips(this.scrollArr[0].getSelected().id + '-' + this.scrollArr[1].getSelected().id + '-' + this.scrollArr[2].getSelected().id);\r\n            },\r\n            //日改变触发回调\r\n            function (item) {\r\n              //scope._setBirth();\r\n              this.setTips(this.scrollArr[0].getSelected().id + '-' + this.scrollArr[1].getSelected().id + '-' + this.scrollArr[2].getSelected().id);\r\n            }\r\n          ],\r\n          onOkAction: function (items) {\r\n            console.log('ok', items);\r\n            scope._setBirth();\r\n            this.hide();\r\n          },\r\n          onCancelAction: function () {\r\n            console.log('cancel');\r\n            this.hide();\r\n          }\r\n        });\r\n      }\r\n      this.list01.show();\r\n      if (birthArray.length == 3) {\r\n        this.list01.scrollArr[0].setId(birthArray[0]);\r\n        this.list01.scrollArr[1].setId(birthArray[1]);\r\n        this.list01.scrollArr[2].setId(birthArray[2]);\r\n        _yearOrMonthChanged(this.list01.scrollArr[0].getSelected(), this.list01.scrollArr[1].getSelected());\r\n      }\r\n    },\r\n   \r\n    _setBirth: function () {\r\n      var curBirth = this.$('.js_demo01_val');\r\n      var yearItem, monthItem, dayItem;\r\n      yearItem = this.list01.scrollArr[0].getSelected();\r\n      monthItem = this.list01.scrollArr[1].getSelected();\r\n      dayItem = this.list01.scrollArr[2].getSelected();\r\n      birth.set({\r\n        year: yearItem.id,\r\n        month: monthItem.id,\r\n        day: dayItem.id\r\n      });\r\n      curBirth.val(yearItem.id + '-' + monthItem.id + '-' + dayItem.id);\r\n    },\r\n    onCreate: function () {\r\n    },\r\n    onShow: function () {\r\n      this.header.set({\r\n        view: this,\r\n        title: 'group select组合应用',\r\n        back: true\r\n      });\r\n      this.header.show();\r\n      var localBirObj = birth.get();\r\n      var curBirth = this.$('.js_demo01_val');\r\n      curBirth.val(localBirObj.year + '-' + localBirObj.month + '-' + localBirObj.day);\r\n    },\r\n    onHide: function () {\r\n    }\r\n  });\r\n  return View;\r\n});    \r\n  </code></pre>\r\n\r\n</script>"});