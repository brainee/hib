define(function(){return"﻿\r\n\r\n<script type=\"text/lizard-config\">\r\n{\r\n  url_schema: [\r\n    '/detail/{id}.html',\r\n    '/detail/{{city}}{{(int)cityId}}'\r\n  ],\r\n  model:{\r\n    apis: [{\r\n      name: 'api1',\r\n      url: 'http://localhost:2000/restful/detail/api1',\r\n      postdata: {\r\n        id: Lizard.P('id'),\r\n        key: Lizard.P('key')\r\n      }\r\n    }, {\r\n      name: 'api2',\r\n      url: 'http://localhost:2000/restful/detail/api2',\r\n      postdata: {\r\n        id: Lizard.P('id'),\r\n        dependents: function() {\r\n          return Lizard.D('api1').request;\r\n        },\r\n        nest: {\r\n          request: (function() {\r\n            // 立即执行的函数不能使用Lizard.D('ap1')\r\n            var even = _.find([1, 2, 3, 4, 5, 6], function(num){ return num % 2 == 0; });\r\n\r\n            return even;\r\n          })()\r\n        }\r\n      },\r\n      suspend: function() {\r\n        var api1 = Lizard.D('api1');\r\n\r\n        return api1.request == 'api1';\r\n      }\r\n    }, {\r\n      name: 'api3',\r\n      url: 'http://localhost:2000/restful/detail/api3',\r\n      postdata: {\r\n        id: Lizard.P('id')\r\n      },\r\n      suspend: function() {\r\n        var api1 = Lizard.D('api1');\r\n\r\n        return api1.request == 'api2';\r\n      }\r\n    }],\r\n    filter: function(datas) {\r\n      var list = [];\r\n\r\n      _.each(datas, function(item) {\r\n        if (!item.list) return;\r\n        list = list.concat(item.list);\r\n      });\r\n\r\n      return {\r\n        request: datas[0].request,\r\n        list: list\r\n      };\r\n    },\r\n    setTDK: function(datas) {\r\n      return {\r\n        title: 'title',\r\n        description: 'detail',\r\n        keywords: 'keywords'\r\n     };\r\n   }\r\n  },\r\n  view:{\r\n    viewport: Lizard.T(\"viewportTmpl\")\r\n  },\r\n  controller: 'webresource/controllers/detail.js'\r\n}\r\n</script>\r\n<script id=\"viewportTmpl\" type=\"text/lizard-template\">\r\n  <h2>suspend test</h2>\r\n  <h3>api name: <%=request%></h3>\r\n  <ul>\r\n    <%_.each(list, function(item) {%>\r\n    <li>\r\n      <%=item.id%>, <%=item.city%>\r\n    <%})%>\r\n  </ul>\r\n</script>"});